# Admin Actions Logger

Плагин для WordPress, который отслеживает и логирует действия пользователей в админ-панели.

## Описание

Admin Actions Logger - это модульный плагин для WordPress, который отслеживает и записывает в лог все важные действия пользователей в админ-панели. Лог доступен для всех пользователей с правами администратора. **Действия пользователя с логином admin и пользователей с ролью "Клиент" (customer) не логируются.**

### Отслеживаемые действия:

1. **Изменения страниц и записей**
   - Создание, обновление и удаление страниц и записей
   - Перемещение в корзину и восстановление из корзины

2. **Редактирование файлов**
   - Изменения в файлах тем (включая function.php)
   - Изменения в файлах плагинов

3. **Изменения настроек**
   - Изменения в основных настройках WordPress
   - Изменения в настройках кастомайзера

4. **WooCommerce**
   - Управление товарами, заказами и купонами
   - Изменения в категориях и атрибутах
   - Изменения настроек и способов доставки

5. **Управление пользователями**
   - Регистрация, обновление и удаление пользователей
   - Изменение ролей пользователей
   - Логирование входа и выхода из системы

6. **Управление меню и виджетами**
   - Создание, обновление и удаление меню
   - Изменения в виджетах

7. **Управление медиафайлами**
   - Загрузка, редактирование и удаление медиафайлов

8. **Управление плагинами и темами**
   - Активация и деактивация плагинов
   - Смена тем
   - Обновление ядра WordPress, плагинов и тем

## Особенности

- **Выборочное логирование**: 
  - Действия пользователя с логином **admin** НЕ записываются в лог
  - Действия пользователей с ролью **Клиент** (customer) НЕ записываются в лог
  - Действия всех остальных пользователей записываются в лог
- **Доступ к логу**: Просмотр лога доступен всем пользователям с правами администратора
- **Модульная архитектура**: Каждый тип логирования выделен в отдельный модуль
- **Интеграция с WooCommerce**: Полная поддержка отслеживания действий в WooCommerce

## Установка

1. Скачайте архив с плагином или склонируйте репозиторий
2. Создайте папку `admin-actions-logger` в директории `/wp-content/plugins/`
3. Распакуйте содержимое архива в эту папку
4. Создайте подпапку `includes` внутри папки `admin-actions-logger`
5. Распределите файлы следующим образом:

```
wp-content/plugins/admin-actions-logger/
├── admin-actions-logger.php
└── includes/
    ├── class-logger.php
    ├── class-admin-page.php
    ├── class-post-logger.php
    ├── class-option-logger.php
    ├── class-file-logger.php
    ├── class-user-logger.php
    ├── class-menu-logger.php
    ├── class-media-logger.php
    └── class-woocommerce-logger.php
```

6. Активируйте плагин в админ-панели WordPress

## Просмотр логов

После установки и активации плагина, лог доступен любому пользователю с правами администратора через меню "Инструменты" > "Лог администратора".

На странице отображается:
- Информация о лог-файле (путь, размер, права доступа)
- Содержимое лога с хронологией действий
- Кнопка для очистки лога

## Техническая информация

### Структура плагина

Плагин разработан с использованием модульной архитектуры:

- `admin-actions-logger.php` - основной файл плагина
- `class-logger.php` - базовый класс для записи в лог
- `class-admin-page.php` - класс для создания административной страницы
- `class-post-logger.php` - класс для отслеживания изменений постов и страниц
- `class-option-logger.php` - класс для отслеживания изменений настроек
- `class-file-logger.php` - класс для отслеживания изменений файлов
- `class-user-logger.php` - класс для отслеживания изменений пользователей
- `class-menu-logger.php` - класс для отслеживания изменений меню и виджетов
- `class-media-logger.php` - класс для отслеживания изменений медиафайлов
- `class-woocommerce-logger.php` - класс для отслеживания изменений WooCommerce

### Лог-файл

Лог сохраняется в файл `/wp-content/settings-changes-log.txt` с правами доступа 0664.

### Требования

- WordPress 4.7 или выше
- PHP 5.6 или выше
- WooCommerce (опционально) для логирования действий WooCommerce

## Решение проблем

Если у вас возникли проблемы с плагином:

1. Проверьте права доступа к лог-файлу (должны быть 0664)
2. Убедитесь, что директория `/wp-content/` доступна для записи
3. Проверьте журнал ошибок PHP и WordPress для выявления возможных проблем
4. При возникновении ошибок обратитесь к разработчику плагина

## Лицензия

Плагин распространяется под лицензией GPL v2 или более поздней версии.

## Автор

Разработано [Bardak]
